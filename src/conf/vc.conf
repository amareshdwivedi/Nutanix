{
    "cluster_checks":[
    {"name" : "CVM's Isolation Response-Leave Powered On", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.configurationEx.dasVmConfig[key-name=NTNX*CVM].dasSettings.isolationResponse", "operator":"=", "ref-value": "none", "severity": 1},
    {"name" : "CPU Compatibility-EVC", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.summary.currentEVCModeKey", "operator":"!=", "ref-value": "None","severity": 2},
    {"name" : "Hosts Connected State", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.host.runtime.connectionState", "operator":"=", "ref-value": "connected","severity": 1},
    {"name" : "Cluster DRS Enabled", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.configuration.drsConfig.enabled", "operator":"=", "ref-value": "True","severity": 2},
    {"name" : "Cluster DRS Automation Mode", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.configuration.drsConfig.defaultVmBehavior", "operator":"=", "ref-value": "fullyAutomated","severity": 2},
    {"name" : "Cluster DRS Automation Mode for CVM", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.configuration.drsVmConfig[key-name=NTNX*CVM].behavior", "operator":"!=", "ref-value": "fullyAutomated","severity": 1},
    {"name" : "Cluster Load Balanced", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.summary.currentBalance", "operator":"<=", "ref-value": "content.rootFolder.childEntity.hostFolder.childEntity.summary.targetBalance","severity": 3},
    {"name" : "Cluster Host Monitoring", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.configuration.dasConfig.hostMonitoring", "operator":"=", "ref-value": "enabled","severity": 1},
    {"name" : "Cluster Admission Control", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.configuration.dasConfig.admissionControlEnabled", "operator":"=", "ref-value": "True","severity": 1},
    {"name" : "Host Isolation Response", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.configuration.dasConfig.defaultVmSettings.isolationResponse", "operator":"=", "ref-value": "powerOff","severity": 1},
    {"name" : "VM Monitoring for CVMs", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.configuration.dasVmConfig[key-name=NTNX*CVM].dasSettings.vmToolsMonitoringSettings.vmMonitoring", "operator":"=", "ref-value": "vmMonitoringDisabled","severity": 1},
    {"name" : "VM Restart Priority for CVMs", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.configuration.dasVmConfig[key-name=NTNX*CVM].dasSettings.restartPriority", "operator":"=", "ref-value": "disabled","severity": 1},
    {"name" : "Cluster Power Management Setting", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.configurationEx.dpmConfigInfo.enabled", "operator":"=", "ref-value": "True","severity": 1},
    {"name" : "VM Swap Placement", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.configurationEx.vmSwapPlacement", "operator":"=", "ref-value": "vmDirectory","severity": 1},
    {"name" : "DataStore Connectivity with Hosts", "path" : "content.rootFolder.childEntity.datastore[name!=NTNX*local*].host.mountInfo.accessible", "operator":"=", "ref-value": "True","severity": 1},
    {"name" : "Cluster Advance Settings das.ignoreInsufficientHbDatastore", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.configuration.dasConfig.option[key=das*ignoreInsufficientHbDatastore].value", "operator":"=", "ref-value": "true","severity": 3},
    {"name" : "Cluster Advance Settings das.useDefaultIsolationAddress", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.configuration.dasConfig.option[key=das*useDefaultIsolationAddress].value", "operator":"=", "ref-value": "false", "severity": 1}
    ],
   
    "esxi_checks":[
    {"name" : "Host HyperThreading Status", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.host.config.hyperThread.active", "operator":"=", "ref-value": "True","severity": 2},
    {"name" : "Hosts Power Management Setting", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.host.hardware.cpuPowerManagementInfo.currentPolicy", "operator":"=", "ref-value": "Balanced","severity": 1},
    {"name" : "ESXi Lockdown Mode", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.host.config.adminDisabled", "operator":"=", "ref-value": "False","severity": 2},
    {"name" : "NTP Servers Configured", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.host.config.dateTimeInfo.ntpConfig.server", "operator":"!=", "ref-value": "None","severity": 1},
    {"name" : "DNS Preferred and Alternate Servers Set for all ESXi Hosts", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.host.config.network.dnsConfig.address", "operator":"!=", "ref-value": "None","severity": 1},
    {"name" : "System log Server IP [Syslog.global.logHost]", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.host.config.option[key=Syslog*global*logHost].value", "operator":"!=", "ref-value": "","severity": 3},
    {"name" : "[Syslog.global.logDirunique] Enabled", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.host.config.option[key=Syslog*global*logDirUnique].value", "operator":"=", "ref-value": "True", "severity": 3}   
    ],
  
    "cvm_checks":[
    {"name" : "CVM DRS Disabled", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.configurationEx.drsVmConfig[key-name=NTNX*CVM].enabled", "operator":"=", "ref-value": "False","severity": 1},
    {"name" : "VM Monitoring For CVMs", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.configurationEx.dasVmConfig[key-name=NTNX*CVM].dasSettings.vmToolsMonitoringSettings.vmMonitoring", "operator":"=", "ref-value": "vmMonitoringDisabled","severity": 1} ,
    {"name" : "VM Restart Priority For CVMs", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.configurationEx.dasVmConfig[key-name=NTNX*CVM].dasSettings.restartPriority", "operator":"!=", "ref-value": "clusterRestartPriority", "severity": 1}
    ],
  
    "vcenter_server_checks":[
    {"name" : "vCenter Server Statistics Interval", "path" : "content.perfManager.historicalInterval.level", "operator":"=", "ref-value": "1","severity": 2},
    {"name" : "vCenter Server SMTP Settings", "path" : "content.setting.setting[key=mail*smtp*server].value", "operator":"!=", "ref-value": "None","severity": 3},
    {"name" : "vCenter Server SNMP Community", "path" : "content.setting.setting[key=snmp*receiver*1*community].value", "operator":"!=", "ref-value": "None","severity": 3},
    {"name" : "vCenter Server SNMP Receiver", "path" : "content.setting.setting[key=snmp*receiver*1*name].value", "operator":"!=", "ref-value": "None","severity": 3},
    {"name" : "vCenter Server Update Manager Installed", "path" : "content.extensionManager.extensionList.description[summary=VMware vSphere Update Manager extension].summary", "operator":"=", "ref-value": "VMware vSphere Update Manager extension", "severity": 3}
    ],
  
    "storage_and_vm_checks":[
    {"name" : "VMware Tools Status on VMs", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.host.vm.guest.toolsStatus", "operator":"=", "ref-value": "toolsOk","severity": 3}
    ],

    "network_and_switch_checks":[
    {"name" : "Virtual Distributed Port - Load Balance", "path" : "content.rootFolder.childEntity.network[key=dvportgroup*].config.defaultPortConfig.uplinkTeamingPolicy.policy.value", "operator":"=", "ref-value": "loadbalance_loadbased","severity": 1},
    {"name" : "Virtual Distributed Port - Network Failover Detection", "path" : "content.rootFolder.childEntity.network[key=dvportgroup*].config.defaultPortConfig.uplinkTeamingPolicy.failureCriteria.checkBeacon.value", "operator":"=", "ref-value": "False","severity": 1},
    {"name" : "Virtual Distributed Port - Notify Switches", "path" : "content.rootFolder.childEntity.network[key=dvportgroup*].config.defaultPortConfig.uplinkTeamingPolicy.notifySwitches.value", "operator":"=", "ref-value": "True","severity": 1},
    {"name" : "Virtual Distributed Port - Failback", "path" : "content.rootFolder.childEntity.network[key=dvportgroup*].config.defaultPortConfig.uplinkTeamingPolicy.rollingOrder.value", "operator":"=", "ref-value": "True","severity": 1},
    {"name" : "Virtual Distributed Port - Virtual Networking Security - Promiscuous Mode", "path" : "content.rootFolder.childEntity.network[key=dvportgroup*].config.defaultPortConfig.securityPolicy.allowPromiscuous.value", "operator":"=", "ref-value": "False","severity": 3},
    {"name" : "Virtual Distributed Port - Virtual Networking Security - MAC Address Changes", "path" : "content.rootFolder.childEntity.network[key=dvportgroup*].config.defaultPortConfig.securityPolicy.macChanges.value", "operator":"=", "ref-value": "False","severity": 3},
    {"name" : "Virtual Distributed Port - Virtual Networking Security - Forged Transmits", "path" : "content.rootFolder.childEntity.network[key=dvportgroup*].config.defaultPortConfig.securityPolicy.forgedTransmits.value", "operator":"=", "ref-value": "False","severity": 3},
    {"name" : "Virtual Standard Switch - Load Balance", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.host.configManager.networkSystem.networkConfig.vswitch[name!=vSwitchNutanix].spec.policy.nicTeaming.policy", "operator":"=", "ref-value": "loadbalance_srcid","severity": 1},
    {"name" : "Virtual Standard Switch - Network Failover Detection", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.host.configManager.networkSystem.networkConfig.vswitch[name!=vSwitchNutanix].spec.policy.nicTeaming.failureCriteria.checkBeacon", "operator":"=", "ref-value": "False","severity": 1},
    {"name" : "Virtual Standard Switch - Notify Switches", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.host.configManager.networkSystem.networkConfig.vswitch[name!=vSwitchNutanix].spec.policy.nicTeaming.notifySwitches", "operator":"=", "ref-value": "True","severity": 1},
    {"name" : "Virtual Standard Switch - Failback", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.host.configManager.networkSystem.networkConfig.vswitch[name!=vSwitchNutanix].spec.policy.nicTeaming.rollingOrder", "operator":"=", "ref-value": "True","severity": 1},
    {"name" : "Virtual Standard Switch - Virtual Networking Security - Promiscuous Mode", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.host.configManager.networkSystem.networkConfig.vswitch[name!=vSwitchNutanix].spec.policy.security.allowPromiscuous", "operator":"=", "ref-value": "False","severity": 3},
    {"name" : "Virtual Standard Switch - Virtual Networking Security - MAC Address Changes", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.host.configManager.networkSystem.networkConfig.vswitch[name!=vSwitchNutanix].spec.policy.security.macChanges", "operator":"=", "ref-value": "False","severity": 3},
    {"name" : "Virtual Standard Switch - Virtual Networking Security - Forged Transmits", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.host.configManager.networkSystem.networkConfig.vswitch[name!=vSwitchNutanix].spec.policy.security.forgedTransmits", "operator":"=", "ref-value": "False", "severity": 3},
    {"name" : "Virtual Standard Switch - MTU", "path" : "content.rootFolder.childEntity.hostFolder.childEntity.host.configManager.networkSystem.networkConfig.vswitch[name!=vSwitchNutanix].spec.mtu", "operator":"=", "ref-value": "1500", "severity": 2}
   ]
}     
    

